# ğŸµ NAS éŸ³ä¹æœåŠ¡å™¨

ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„åŸºäº Node.js çš„éŸ³ä¹æœåŠ¡å™¨ï¼Œæ”¯æŒæœ¬åœ°éŸ³ä¹ç®¡ç†ã€åœ¨çº¿éŸ³ä¹æœç´¢å’Œæ•°æ®åŒæ­¥åŠŸèƒ½ã€‚

## ğŸ“¸ ç³»ç»Ÿæˆªå›¾

### ä¸»é¡µé¢
![ä¸»é¡µé¢](/screenimg/homepage.png)

### ä¸“è¾‘ç®¡ç†
![ä¸“è¾‘ç®¡ç†](/screenimg/albumpage.png)

### è‰ºæœ¯å®¶ç®¡ç†
![è‰ºæœ¯å®¶ç®¡ç†](/screenimg/artistpage.png)

### è®¾ç½®é¡µé¢
![è®¾ç½®é¡µé¢](/screenimg/settingpage.png)

### éŸ³ä¹è¯¦æƒ…
![éŸ³ä¹è¯¦æƒ…](/screenimg/musicdetail.png)

### è‰ºæœ¯å®¶è¯¦æƒ…
![è‰ºæœ¯å®¶è¯¦æƒ…](/screenimg/artistdetail.png)

## âœ¨ åŠŸèƒ½ç‰¹æ€§

### ğŸµ æœ¬åœ°éŸ³ä¹ç®¡ç†
- **ğŸ“ åª’ä½“åº“æ‰«æ**: è‡ªåŠ¨æ‰«ææœ¬åœ°éŸ³ä¹æ–‡ä»¶ï¼Œæ”¯æŒå¤šç§éŸ³é¢‘æ ¼å¼
- **ğŸ·ï¸ å…ƒæ•°æ®æå–**: è‡ªåŠ¨æå–éŸ³ä¹æ–‡ä»¶çš„æ ‡ç­¾ä¿¡æ¯ï¼ˆæ ‡é¢˜ã€è‰ºæœ¯å®¶ã€ä¸“è¾‘ç­‰ï¼‰
- **ğŸ“Š æ™ºèƒ½åˆ†ç±»**: æŒ‰ä¸“è¾‘ã€è‰ºæœ¯å®¶ã€æµæ´¾ç­‰è‡ªåŠ¨åˆ†ç±»ç®¡ç†
- **ğŸ”„ æ•°æ®åŒæ­¥**: ä¸åœ¨çº¿éŸ³ä¹æœåŠ¡åŒæ­¥ï¼Œè·å–æ›´å®Œæ•´çš„éŸ³ä¹ä¿¡æ¯
- **â¤ï¸ æ”¶è—åŠŸèƒ½**: æ”¯æŒéŸ³ä¹æ”¶è—å’Œæ’­æ”¾å†å²è®°å½•

### ğŸ” åœ¨çº¿éŸ³ä¹æœç´¢
- **ğŸŒ å¤šå¹³å°æœç´¢**: æ”¯æŒç½‘æ˜“äº‘éŸ³ä¹ã€QQéŸ³ä¹ã€é…·ç‹—éŸ³ä¹ç­‰ä¸»æµå¹³å°
- **ğŸ¯ æ™ºèƒ½åŒ¹é…**: åŸºäºæœ¬åœ°éŸ³ä¹ä¿¡æ¯æ™ºèƒ½åŒ¹é…åœ¨çº¿èµ„æº
- **ğŸ“ æ­Œè¯è·å–**: è‡ªåŠ¨è·å–å’Œæ˜¾ç¤ºæ­Œè¯ä¿¡æ¯
- **ğŸ–¼ï¸ å°é¢ä¸‹è½½**: è‡ªåŠ¨ä¸‹è½½ä¸“è¾‘å°é¢å›¾ç‰‡
- **ğŸ’¾ ç¼“å­˜æœºåˆ¶**: æ™ºèƒ½ç¼“å­˜æœç´¢ç»“æœï¼Œæé«˜å“åº”é€Ÿåº¦

### ğŸ¨ ç”¨æˆ·ç•Œé¢
- **ğŸ¨ ç°ä»£åŒ–è®¾è®¡**: é‡‡ç”¨ç°ä»£åŒ–çš„UIè®¾è®¡ï¼Œæ”¯æŒæ·±è‰²ä¸»é¢˜
- **ğŸ“± å“åº”å¼å¸ƒå±€**: å®Œç¾é€‚é…æ¡Œé¢ç«¯ã€å¹³æ¿å’Œç§»åŠ¨ç«¯
- **ğŸ” å®æ—¶æœç´¢**: æ”¯æŒå®æ—¶æœç´¢å’Œè¿‡æ»¤åŠŸèƒ½
- **ğŸ® æ’­æ”¾æ§åˆ¶**: é›†æˆéŸ³ä¹æ’­æ”¾å™¨ï¼Œæ”¯æŒæ’­æ”¾æ§åˆ¶
- **ğŸ“Š æ•°æ®ç»Ÿè®¡**: å®æ—¶æ˜¾ç¤ºéŸ³ä¹åº“ç»Ÿè®¡ä¿¡æ¯

### ğŸ”§ ç³»ç»Ÿç®¡ç†
- **âš™ï¸ è®¾ç½®ç®¡ç†**: å®Œæ•´çš„ç³»ç»Ÿè®¾ç½®ç•Œé¢
- **ğŸ”„ æ•°æ®åŒæ­¥**: ä¸€é”®åŒæ­¥æœ¬åœ°ä¸åœ¨çº¿éŸ³ä¹æ•°æ®
- **ğŸ” åˆ®å‰ŠåŠŸèƒ½**: è‡ªåŠ¨è·å–éŸ³ä¹å…ƒæ•°æ®ä¿¡æ¯
- **ğŸ“ˆ æ€§èƒ½ç›‘æ§**: å†…å­˜ä½¿ç”¨å’Œç³»ç»Ÿæ€§èƒ½ç›‘æ§

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚
- Node.js 18.0 æˆ–æ›´é«˜ç‰ˆæœ¬
- npm æˆ– yarn åŒ…ç®¡ç†å™¨
- æ”¯æŒçš„æ“ä½œç³»ç»Ÿï¼šWindowsã€macOSã€Linux

### å®‰è£…æ­¥éª¤

1. **å…‹éš†é¡¹ç›®**
```bash
git clone https://gitee.com/yanfanVIP/nas-music.git
cd nas-music-server
```

2. **å®‰è£…ä¾èµ–**
```bash
npm install
```

3. **å¯åŠ¨æœåŠ¡å™¨**
```bash
npm start
```

4. **è®¿é—®åº”ç”¨**
æ‰“å¼€æµè§ˆå™¨è®¿é—® `http://localhost:3000`

### å¼€å‘æ¨¡å¼
```bash
npm run dev
```

## ğŸ“ é¡¹ç›®ç»“æ„

```
music-server/
â”œâ”€â”€ src/                    # åç«¯æºä»£ç 
â”‚   â”œâ”€â”€ api/               # API è·¯ç”±
â”‚   â”œâ”€â”€ client/            # æ•°æ®åº“å®¢æˆ·ç«¯
â”‚   â”œâ”€â”€ middlewares/       # ä¸­é—´ä»¶
â”‚   â”œâ”€â”€ plugins/           # æ’ä»¶ç³»ç»Ÿ
â”‚   â””â”€â”€ utils/             # å·¥å…·å‡½æ•°
â”œâ”€â”€ web/                   # å‰ç«¯æºä»£ç 
â”‚   â”œâ”€â”€ components/        # React ç»„ä»¶
â”‚   â”œâ”€â”€ views/             # é¡µé¢ç»„ä»¶
â”‚   â””â”€â”€ hooks/             # è‡ªå®šä¹‰ Hooks
â”œâ”€â”€ db/                    # æ•°æ®åº“æ–‡ä»¶
â”œâ”€â”€ music/                 # éŸ³ä¹æ–‡ä»¶ç›®å½•
â””â”€â”€ package.json           # é¡¹ç›®é…ç½®
```

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

### åç«¯æŠ€æœ¯
- **Node.js**: æœåŠ¡å™¨è¿è¡Œç¯å¢ƒ
- **Koa**: Web æ¡†æ¶
- **SQLite**: è½»é‡çº§æ•°æ®åº“
- **better-sqlite3**: SQLite æ•°æ®åº“é©±åŠ¨
- **music-metadata**: éŸ³ä¹å…ƒæ•°æ®è§£æ

### å‰ç«¯æŠ€æœ¯
- **React**: ç”¨æˆ·ç•Œé¢æ¡†æ¶
- **React Router**: è·¯ç”±ç®¡ç†
- **CSS3**: æ ·å¼è®¾è®¡
- **Fetch API**: ç½‘ç»œè¯·æ±‚

### å¼€å‘å·¥å…·
- **Vite**: å‰ç«¯æ„å»ºå·¥å…·
- **Nodemon**: å¼€å‘ç¯å¢ƒè‡ªåŠ¨é‡å¯
- **ESLint**: ä»£ç è´¨é‡æ£€æŸ¥

## ğŸ“Š æ•°æ®åº“è®¾è®¡

### ä¸»è¦æ•°æ®è¡¨
- **music**: éŸ³ä¹æ–‡ä»¶ä¿¡æ¯
- **albums**: ä¸“è¾‘ä¿¡æ¯
- **artists**: è‰ºæœ¯å®¶ä¿¡æ¯
- **online_music**: åœ¨çº¿éŸ³ä¹ç¼“å­˜
- **config**: ç³»ç»Ÿé…ç½®

### åœ¨çº¿éŸ³ä¹ç¼“å­˜æœºåˆ¶
ç³»ç»Ÿä¼šè‡ªåŠ¨å°†åœ¨çº¿æœç´¢çš„éŸ³ä¹ç»“æœç¼“å­˜åˆ° `online_music` è¡¨ä¸­ï¼š

```sql
CREATE TABLE online_music (
  id TEXT PRIMARY KEY,           -- musicId + albumId çš„ MD5 å“ˆå¸Œ
  musicId TEXT NOT NULL,         -- MusicBrainz éŸ³ä¹ ID
  score INTEGER NOT NULL,        -- æœç´¢åŒ¹é…åº¦
  title TEXT NOT NULL,           -- æ­Œæ›²æ ‡é¢˜
  artist TEXT NOT NULL,          -- è‰ºæœ¯å®¶
  album TEXT NOT NULL,           -- ä¸“è¾‘åç§°
  coverImage TEXT,               -- ä¸“è¾‘å°é¢ URL
  lyrics TEXT,                   -- æ­Œè¯å†…å®¹
  created_at TEXT,               -- åˆ›å»ºæ—¶é—´
  updated_at TEXT                -- æ›´æ–°æ—¶é—´
)
```

## ğŸ”Œ API æ¥å£

### éŸ³ä¹ç®¡ç†
- `GET /api/music/tracks` - è·å–éŸ³ä¹åˆ—è¡¨
- `GET /api/music/albums` - è·å–ä¸“è¾‘åˆ—è¡¨
- `GET /api/music/artists` - è·å–è‰ºæœ¯å®¶åˆ—è¡¨
- `PUT /api/music/tracks/:id/favorite` - è®¾ç½®æ”¶è—çŠ¶æ€

### åœ¨çº¿æœç´¢
- `GET /api/online/search/music` - æœç´¢åœ¨çº¿éŸ³ä¹
- `GET /api/online/search/album` - æœç´¢ä¸“è¾‘ä¿¡æ¯
- `GET /api/online/lyrics` - è·å–æ­Œè¯

### ç³»ç»Ÿè®¾ç½®
- `GET /api/settings/media-libraries` - è·å–åª’ä½“åº“åˆ—è¡¨
- `POST /api/settings/media-libraries` - æ·»åŠ åª’ä½“åº“
- `POST /api/settings/data-sync` - æ•°æ®åŒæ­¥
- `POST /api/settings/scraping/start` - å¯åŠ¨åˆ®å‰Š

## ğŸ¯ ä½¿ç”¨æŒ‡å—

### 1. æ·»åŠ åª’ä½“åº“
1. æ‰“å¼€è®¾ç½®é¡µé¢
2. åœ¨"åª’ä½“åº“ç®¡ç†"åŒºåŸŸè¾“å…¥éŸ³ä¹æ–‡ä»¶å¤¹è·¯å¾„
3. ç‚¹å‡»"æ·»åŠ åª’ä½“åº“"æŒ‰é’®
4. ç³»ç»Ÿä¼šè‡ªåŠ¨æ‰«æå¹¶å¯¼å…¥éŸ³ä¹æ–‡ä»¶

### 2. æ•°æ®åŒæ­¥
1. åœ¨è®¾ç½®é¡µé¢æ‰¾åˆ°"æ•°æ®åŒæ­¥"åŒºåŸŸ
2. ç‚¹å‡»"ç«‹å³åŒæ­¥"æŒ‰é’®
3. ç³»ç»Ÿä¼šä¸åœ¨çº¿éŸ³ä¹æœåŠ¡åŒæ­¥æ•°æ®

### 3. éŸ³ä¹æœç´¢
1. åœ¨éŸ³ä¹åˆ—è¡¨é¡µé¢ä½¿ç”¨æœç´¢æ¡†
2. æ”¯æŒæŒ‰æ ‡é¢˜ã€è‰ºæœ¯å®¶ã€ä¸“è¾‘æœç´¢
3. å®æ—¶æ˜¾ç¤ºæœç´¢ç»“æœ

### 4. åœ¨çº¿éŸ³ä¹æœç´¢
1. åœ¨éŸ³ä¹è¯¦æƒ…é¡µé¢ç‚¹å‡»"åœ¨çº¿æœç´¢"
2. ç³»ç»Ÿä¼šä»å¤šä¸ªå¹³å°æœç´¢ç›¸å…³ä¿¡æ¯
3. è‡ªåŠ¨ç¼“å­˜æœç´¢ç»“æœä»¥æé«˜æ€§èƒ½

## ğŸ”§ é…ç½®è¯´æ˜

### ç¯å¢ƒå˜é‡
```bash
# æœåŠ¡å™¨ç«¯å£
PORT=3000

# æ•°æ®åº“è·¯å¾„
DB_PATH=./db/music.db

# éŸ³ä¹æ–‡ä»¶ç›®å½•
MUSIC_PATH=./music
```

### é…ç½®æ–‡ä»¶
ç³»ç»Ÿé…ç½®å­˜å‚¨åœ¨ `db/config` è¡¨ä¸­ï¼ŒåŒ…æ‹¬ï¼š
- åª’ä½“åº“è·¯å¾„åˆ—è¡¨
- åˆ®å‰ŠåŠŸèƒ½å¼€å…³
- åœ¨çº¿æœç´¢é…ç½®
- ç³»ç»Ÿåå¥½è®¾ç½®

## ğŸ› æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **åª’ä½“åº“æ‰«æå¤±è´¥**
   - æ£€æŸ¥æ–‡ä»¶è·¯å¾„æ˜¯å¦æ­£ç¡®
   - ç¡®è®¤æ–‡ä»¶æ ¼å¼æ˜¯å¦æ”¯æŒ
   - æŸ¥çœ‹æ§åˆ¶å°é”™è¯¯ä¿¡æ¯

2. **åœ¨çº¿æœç´¢æ— ç»“æœ**
   - æ£€æŸ¥ç½‘ç»œè¿æ¥
   - ç¡®è®¤ API é…ç½®æ­£ç¡®
   - å°è¯•æ¸…é™¤ç¼“å­˜æ•°æ®

3. **å†…å­˜å ç”¨è¿‡é«˜**
   - å‡å°‘åŒæ—¶æ‰«æçš„æ–‡ä»¶æ•°é‡
   - å¯ç”¨åƒåœ¾å›æ”¶åŠŸèƒ½
   - å®šæœŸæ¸…ç†ç¼“å­˜æ•°æ®

### æ—¥å¿—æŸ¥çœ‹
```bash
# æŸ¥çœ‹åº”ç”¨æ—¥å¿—
npm start > app.log 2>&1

# æŸ¥çœ‹é”™è¯¯æ—¥å¿—
tail -f app.log | grep ERROR
```

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

### å¼€å‘æµç¨‹
1. Fork é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
3. æäº¤ä»£ç æ›´æ”¹
4. åˆ›å»º Pull Request

### ä»£ç è§„èŒƒ
- ä½¿ç”¨ ESLint è¿›è¡Œä»£ç æ£€æŸ¥
- éµå¾ªé¡¹ç›®ç°æœ‰çš„ä»£ç é£æ ¼
- æ·»åŠ å¿…è¦çš„æ³¨é‡Šå’Œæ–‡æ¡£

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## ğŸ™ è‡´è°¢

æ„Ÿè°¢ä»¥ä¸‹å¼€æºé¡¹ç›®çš„æ”¯æŒï¼š
- [better-sqlite3](https://github.com/WiseLibs/better-sqlite3)
- [music-metadata](https://github.com/Borewit/music-metadata)
- [Koa](https://koajs.com/)
- [React](https://reactjs.org/)

## ğŸ“ è”ç³»æ–¹å¼

- é¡¹ç›®ä¸»é¡µï¼šhttps://github.com/your-username/nas-music-server
- é—®é¢˜åé¦ˆï¼šhttps://github.com/your-username/nas-music-server/issues
- é‚®ç®±ï¼šyour-email@example.com

---

â­ å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™å®ƒä¸€ä¸ªæ˜Ÿæ ‡ï¼